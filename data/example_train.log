========== Training with labeled data ==========
== Loading dev dataset ==
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 5075.78it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 2879855.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 340/340 [00:00<00:00, 5223.60it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 340/340 [00:00<00:00, 2537479.29it/s]
== Loading pre-trained model ==
/mnt/fast/nobackup/users/hl01486/miniconda3/envs/avgen/lib/python3.10/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
== Loading model params done ==
== Training start ==
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 26.58it/s]
epoch:0, train_loss:1.175, val_acc:0.818
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.40it/s]
epoch:1, train_loss:0.417, val_acc:0.831
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.62it/s]
epoch:2, train_loss:0.285, val_acc:0.856
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.15it/s]
epoch:3, train_loss:0.231, val_acc:0.863
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.37it/s]
epoch:4, train_loss:0.159, val_acc:0.876
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.10it/s]
epoch:5, train_loss:0.132, val_acc:0.886
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.72it/s]
epoch:6, train_loss:0.125, val_acc:0.893
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.73it/s]
epoch:7, train_loss:0.084, val_acc:0.900
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.48it/s]
epoch:8, train_loss:0.065, val_acc:0.907
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.30it/s]
epoch:9, train_loss:0.066, val_acc:0.912
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.64it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.35it/s]
epoch:10, train_loss:0.046, val_acc:0.915
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.16it/s]
epoch:11, train_loss:0.053, val_acc:0.917
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.11it/s]
epoch:12, train_loss:0.040, val_acc:0.919
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.64it/s]
epoch:13, train_loss:0.030, val_acc:0.921
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 27.34it/s]
epoch:14, train_loss:0.032, val_acc:0.925
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 27.93it/s]
epoch:15, train_loss:0.016, val_acc:0.926
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.15it/s]
epoch:16, train_loss:0.022, val_acc:0.929
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.29it/s]
epoch:17, train_loss:0.015, val_acc:0.931
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 27.81it/s]
epoch:18, train_loss:0.011, val_acc:0.934
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 28.52it/s]
epoch:19, train_loss:0.009, val_acc:0.936
best_epoch:19, best_metric:0.936

========== Pseudo labeling ==========
== Loading model ckpt ==
== Loading model params done ==
== Train pseudo labeling ==
6959
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5560/5560 [00:01<00:00, 5306.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5560/5560 [00:00<00:00, 3736034.96it/s]
== Testing start ==
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5560/5560 [00:15<00:00, 361.98it/s]
== Val pseudo labeling ==
1739
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 5015.22it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 3297038.52it/s]
== Testing start ==
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:04<00:00, 347.49it/s]
========== Pseudo label training ==========
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6960/6960 [00:01<00:00, 5270.57it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6960/6960 [00:00<00:00, 2807227.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1740/1740 [00:00<00:00, 5175.92it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1740/1740 [00:00<00:00, 2731320.72it/s]
== Loading model ckpt ==
/mnt/fast/nobackup/users/hl01486/miniconda3/envs/avgen/lib/python3.10/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
== Loading model params done ==
== Training start ==
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.48it/s]
epoch:0, train_loss:0.860, val_acc:0.880
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.67it/s]
epoch:1, train_loss:0.261, val_acc:0.882
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.53it/s]
epoch:2, train_loss:0.190, val_acc:0.906
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.73it/s]
epoch:3, train_loss:0.162, val_acc:0.914
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.95it/s]
epoch:4, train_loss:0.116, val_acc:0.925
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.66it/s]
epoch:5, train_loss:0.107, val_acc:0.932
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.77it/s]
epoch:6, train_loss:0.093, val_acc:0.937
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 35.02it/s]
epoch:7, train_loss:0.085, val_acc:0.941
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.53it/s]
epoch:8, train_loss:0.078, val_acc:0.944
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.60it/s]
epoch:9, train_loss:0.076, val_acc:0.946
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.64it/s]
epoch:10, train_loss:0.068, val_acc:0.946
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.37it/s]
epoch:11, train_loss:0.057, val_acc:0.947
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.62it/s]
epoch:12, train_loss:0.049, val_acc:0.949
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.75it/s]
epoch:13, train_loss:0.057, val_acc:0.951
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.93it/s]
epoch:14, train_loss:0.050, val_acc:0.953
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.80it/s]
epoch:15, train_loss:0.042, val_acc:0.954
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.87it/s]
epoch:16, train_loss:0.036, val_acc:0.955
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.60it/s]
epoch:17, train_loss:0.040, val_acc:0.956
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.79it/s]
epoch:18, train_loss:0.036, val_acc:0.957
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.70it/s]
epoch:19, train_loss:0.029, val_acc:0.957
best_epoch:19, best_metric:0.957