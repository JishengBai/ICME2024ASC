========== Training with labeled data ==========
== Loading dev dataset ==
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 5219.56it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 2874217.13it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 340/340 [00:00<00:00, 1331.10it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 340/340 [00:00<00:00, 2488766.77it/s]
== Loading pre-trained model ==
/mnt/fast/nobackup/users/hl01486/miniconda3/envs/avgen/lib/python3.10/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
== Loading model params done ==
== Training start ==
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00,  9.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 30.54it/s]
epoch:0, train_loss:1.175, val_acc:0.818
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 31.74it/s]
epoch:1, train_loss:0.417, val_acc:0.831
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 29.24it/s]
epoch:2, train_loss:0.285, val_acc:0.856
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 29.70it/s]
epoch:3, train_loss:0.231, val_acc:0.863
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 30.70it/s]
epoch:4, train_loss:0.159, val_acc:0.876
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 30.78it/s]
epoch:5, train_loss:0.132, val_acc:0.886
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 30.69it/s]
epoch:6, train_loss:0.125, val_acc:0.893
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 30.64it/s]
epoch:7, train_loss:0.084, val_acc:0.900
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 30.97it/s]
epoch:8, train_loss:0.065, val_acc:0.907
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 31.04it/s]
epoch:9, train_loss:0.066, val_acc:0.912
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 30.74it/s]
epoch:10, train_loss:0.046, val_acc:0.915
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 30.19it/s]
epoch:11, train_loss:0.053, val_acc:0.917
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 30.54it/s]
epoch:12, train_loss:0.040, val_acc:0.919
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 31.36it/s]
epoch:13, train_loss:0.030, val_acc:0.921
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 31.48it/s]
epoch:14, train_loss:0.032, val_acc:0.925
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 31.58it/s]
epoch:15, train_loss:0.016, val_acc:0.926
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 31.81it/s]
epoch:16, train_loss:0.022, val_acc:0.929
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 31.74it/s]
epoch:17, train_loss:0.015, val_acc:0.931
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 31.07it/s]
epoch:18, train_loss:0.011, val_acc:0.934
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:04<00:00, 10.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 31.24it/s]
epoch:19, train_loss:0.009, val_acc:0.936
best_epoch:19, best_metric:0.936

========== Pseudo labeling ==========
== Loading model ckpt ==
== Loading model params done ==
== Train pseudo labeling ==
6959
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5560/5560 [00:04<00:00, 1304.44it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 5560/5560 [00:00<00:00, 3712246.14it/s]
== Testing start ==
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5560/5560 [00:14<00:00, 375.01it/s]
== Val pseudo labeling ==
1739
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:01<00:00, 1296.30it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 3361205.27it/s]
== Testing start ==
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:03<00:00, 375.78it/s]
========== Pseudo label training ==========
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6960/6960 [00:01<00:00, 5134.83it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 6960/6960 [00:00<00:00, 2830911.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1740/1740 [00:00<00:00, 4975.92it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 1740/1740 [00:00<00:00, 2665481.72it/s]
== Loading model ckpt ==
/mnt/fast/nobackup/users/hl01486/miniconda3/envs/avgen/lib/python3.10/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
== Loading model params done ==
== Training start ==
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 11.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.80it/s]
epoch:0, train_loss:0.860, val_acc:0.880
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 11.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.86it/s]
epoch:1, train_loss:0.261, val_acc:0.882
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 11.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.90it/s]
epoch:2, train_loss:0.190, val_acc:0.906
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.69it/s]
epoch:3, train_loss:0.162, val_acc:0.914
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.92it/s]
epoch:4, train_loss:0.116, val_acc:0.925
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.75it/s]
epoch:5, train_loss:0.107, val_acc:0.932
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.62it/s]
epoch:6, train_loss:0.093, val_acc:0.937
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.72it/s]
epoch:7, train_loss:0.085, val_acc:0.941
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.60it/s]
epoch:8, train_loss:0.078, val_acc:0.944
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.63it/s]
epoch:9, train_loss:0.076, val_acc:0.946
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.74it/s]
epoch:10, train_loss:0.068, val_acc:0.946
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.74it/s]
epoch:11, train_loss:0.057, val_acc:0.947
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.58it/s]
epoch:12, train_loss:0.049, val_acc:0.949
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.65it/s]
epoch:13, train_loss:0.057, val_acc:0.951
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 38.80it/s]
epoch:14, train_loss:0.050, val_acc:0.953
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.54it/s]
epoch:15, train_loss:0.042, val_acc:0.954
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.67it/s]
epoch:16, train_loss:0.036, val_acc:0.955
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.78it/s]
epoch:17, train_loss:0.040, val_acc:0.956
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.55it/s]
epoch:18, train_loss:0.036, val_acc:0.957
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 218/218 [00:19<00:00, 10.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 55/55 [00:01<00:00, 39.58it/s]
epoch:19, train_loss:0.029, val_acc:0.957
best_epoch:19, best_metric:0.957